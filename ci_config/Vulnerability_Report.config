model_version: 2.0
xray:
  name: Backup and Restore Orchestrator
  version: {version}
  paths:
    - "ARM-SELI/proj-adp-eric-ctrl-bro-internal-docker-global/proj-adp-eric-ctrl-bro-internal/eric-ctrl-bro/{version}"
    - "ARM-SELI/proj-adp-eric-ctrl-bro-internal-docker-global/proj-adp-eric-ctrl-bro-internal/eric-ctrl-bro-hooklauncher/{version}"
product_va_config:
  name: Backup and Restore Orchestrator
  product_name: eric-ctrl-bro
  version: {version}
  description: The primary goal of the Backup and Restore Orchestrator service is to provide a consistent set of APIs for backup and restore operation orchestration across multiple services.
  images:
    - ARM-SELI/proj-adp-eric-ctrl-bro-internal-docker-global/proj-adp-eric-ctrl-bro-internal/eric-ctrl-bro/{version}
    - ARM-SELI/proj-adp-eric-ctrl-bro-internal-docker-global/proj-adp-eric-ctrl-bro-internal/eric-ctrl-bro-hooklauncher/{version}
  mitigations:
    CVE-2023-35116:
      mitigation: No impact. Vulnerable component is included as part of BRO. However, jackson databind community does not consider this as a security issue and are revoking this CVE. BRO is not exposed externally to the cluster and uses trusted input, an attacker would require cluster access for malicious input.
      sce:
        sce-id: SCED-2023-001041-a1
        status: Approved
        expires: 2023-12-31
    CVE-2016-1000027:
      mitigation: No action. We use JSON as our serialization format.  BRO is not affected as we do not expose HTTP-invoke endpoints, and use json as our serialization format. Uplift of Springboot will remove this vulnerability
      sce:
        sce-id: SCE-2022-1890
        status: Approved
        expires: 2024-10-04
    CVE-1999-0524:
      mitigation: No impact. Its a false positive. BRO uses SUSE Linux Enterprise Server 15 SP4 and this version is not affected by the vulnerability
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2023-33201:
      mitigation: No Impact, BRO does not use the "LDAP CertStore" provided by the library. An uplift to a newer version to remove the FP in a later release. 
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    GHSA-r68h-jhhj-9jvm:
      mitigation: No Impact. BRO uses OWASP ESAPIi 2.4.0 exclusively to validate backup names and patterns defined in ESAPI.properties, no validHTML validate requests are made, so is not using the Validator.isValidSafeHTML methods with the vulnerability. This CVE will be removed in a later ESAPI uplift.
      sce:
        sce-id: SCED-2023-101747
        status: Approved
        expires: 2024-10-29
    CVE-2023-48795:
      mitigation: Not Applicable. BRO does not use openssh extensions when using the jsch library. This vulnerability will be removed by uplifting mwiede:jsch once the fixed version is available.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-24549:
      mitigation: Not Applicable.  The vulnerability affects HTTP/2 requests specifically, requiring the implementation of the org.apache.coyote.http2 package, which BRO does not utilize; instead, it uses org.apache.coyote.http11 for HTTP/1.1 processing.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-22243:
      mitigation: Not Applicable. The target method UriComponentsBuilder is used in BRO internally to build and manipulate URI components. no uses for parsing an externally provided URL. the CVE will be fixed when spring-web uplift to a newer version
      sce:
        sce-id: SCED-2024-000312
        status: Approved
        expires: 2024-07-31
    XRAY-589059:
      mitigation: Not Applicable. the maintainers of Maven Central had deemed this attack is not feasible. the vulnerability will be fixed when Jackson & slf4j uplifted
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-22259:
      mitigation: No Impact. The target method UriComponentsBuilder is used in BRO internally to build and manipulate URI components. No uses for parsing an externally provided URL. This CVE will be fixed when spring-web uplift to a newer version
      sce:
        sce-id: SCED-2024-000399-a1
        status: Approved
        expires: 2024-09-14
    CVE-2024-23672:
      mitigation: No impact, the CVE target to WebSocket from Apache Tomcat, this is a sub-dependency from spring-boot-starter-tomcat, from spring-boot-starter-web. there is no usage of WebSocket in BRO. the CVE will be fixed when spring-boot-starter-web uplifts to a newer version which contains fixed Apache Tomcat.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-21634:
      mitigation: No impact, BRO does not use the ion-java specific format in communication with OSMN. Uplift to a new version of aws-java-sdk-s3 once the fixed version is available.
      sce:
        sce-id: SCED-2024-000688
        status: Approved
        expires: 2024-10-29
    CVE-2024-22262:
      mitigation: No Impact. The target method UriComponentsBuilder is used in BRO internally to build and manipulate URI components. No uses for parsing an externally provided URL. This CVE will be fixed when uplift to a fix version of spring-web
      sce:
        sce-id: SCED-2024-000688
        status: Approved
        expires: 2024-10-29
    CVE-2021-31684:
      mitigation: No Impact. the target 3pp json-smart is from kubernetes:client-java which is used to configure K8s APIs in BRO, with no usage towards json-smart. the CVE will be fixed when BRO uplifts kubernetes:client-java (which contains json-smart >= 2.5) in a later release.
      sce:
        sce-id: SCED-2024-000688-a1
        status: Approved
        expires: 2024-10-29
    CVE-2023-1370:
      mitigation: No Impact. the target 3pp json-smart is from kubernetes:client-java which is used to configure K8s APIs in BRO, with no usage towards json-smart. the CVE will be fixed when BRO uplifts kubernetes:client-java (which contains json-smart >= 2.5) in a later release.
      sce:
        sce-id: SCED-2024-000688-a1
        status: Approved
        expires: 2024-10-29
    CVE-2023-52428:
      mitigation: No impact, the target package "nimbus-jose-jwt-9.8.1.jar" is included in "kubernetes-client-java jar-20.0.1" and is not used in BRO. The CVE will be fixed when kubernetes-client-java uplifts to a newer version which contains the fixed version for "nimbus-jose-jwt".
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-34447:
      mitigation: No impact, BRO uses Bouncy Castle Java Cryptography APIs to build/parse certificates but does not use BCJSSE (Bouncy Castle Java Secure Socket Extension). This CVE will be fixed when "bcprov-jdk18on" uplifts to 1.78 or newer version.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-29857:
      mitigation: No impact, the target package "org.bouncycastle bcpkix-jdk18on" is from k8s-client used in BRO, the vulnerable ECCurve.java and ECCurve.cs not used in BRO. This CVE will be fixed when BRO uplifts to a version of k8s-client-java containing the fix of 1.78+ version of bouncycastle.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-30171:
      mitigation: No impact, the target package "org.bouncycastle bcpkix-jdk18on" is from k8s-client used in BRO. Bouncy Castle Java Cryptography APIs is used to build/parse certificates but BRO does not use that for secure communications over TLS with RSA-based handshakes. This CVE will be fixed when BRO uplifts to a version of k8s-client-java containing the fix of 1.78+ version of bouncycastle.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-30172:
      mitigation: No impact, the target package "org.bouncycastle bcpkix-jdk18on" is from k8s-client used in BRO. Bouncy Castle Java Cryptography APIs is used to build/parse certificates but BRO does not use that to verify keys. This CVE will be fixed when BRO uplifts to a version of k8s-client-java containing the fix of 1.78+ version of bouncycastle.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    CVE-2024-3933:
      mitigation: No impact, BRO does not use JVM option concurrentScavenge. CVE will be removed when JDK is updated.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    open_ports:
      3000-tcp:
        mitigation: Intended open port
        intended: true
        sce:
          sce-id: N/A
          status: N/A
          expires: N/A
      7001-tcp:
        mitigation: Intended open port
        intended: true
        sce:
          sce-id: N/A
          status: N/A
          expires: N/A
    tenable_sc_plugin_id:
      45410:
        plugin_name: SSL Certificate 'commonName' Mismatch
        mitigation: False positive CVE found by Tenable SC. Tenable SC configuration needs update.
        sce:
          sce-id: SCE-2020-709
          status: Approved
          expires: N/A
      51192:
        plugin_name: SSL Certificate 'commonName' Mismatch
        mitigation: False positive CVE found by Tenable SC. Tenable SC configuration needs update.
        sce:
          sce-id: SCE-2020-709
          status: Approved
          expires: N/A
      136318:
        plugin_name: TLS Version 1.2 Protocol Detection
        mitigation: TLS 1.3 only migration ongoing, awaiting CBOS support.
        sce:
          sce-id: N/A
          status: N/A
          expires: N/A
      10114:
        plugin_name: ICMP Timestamp Request Remote Date Disclosure
        mitigation: No impact. The time on the server is exposed in ICMP timestamp response.
        sce:
          sce-id: N/A
          status: N/A
          expires: N/A
    AutomountServiceAccountToken:
      mitigation: This finding is not applicable. Service account identity token must be mounted before the Kubernetes API can be used.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    RunAsGroup:
      mitigation: This finding can be considered a false positive because BRO sets the GID
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    ApparmorAny:
      mitigation: No action. This is a false positive. As per DR-D1123-127, ADP services shall set AppArmor profile with '' as default value
      sce:
        sce-id: SCE-2022-2292
        status: Approved
        expires: N/A
    StatefulSet/eric-ctrl-bro.default-SeccompAny:
      mitigation: No action. This is a false positive. As per DR-D1123-18, ADP services shall set seccomp profile with '' as default value.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
    StatefulSet/eric-ctrl-bro.default-RunAsUser:
      mitigation: No action. This is a false positive. The user in the BRO container already uses a value greater than 10000.
      sce:
        sce-id: N/A
        status: N/A
        expires: N/A
